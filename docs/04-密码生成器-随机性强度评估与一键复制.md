# 04｜密码生成器：随机性、强度评估与一键复制

本篇拆解 DevTools Hub 的“密码生成器”工具：从字符集选择、随机性、安全提示，到复制/批量生成功能与 UI 反馈。

## 1. 字符集与长度

- 基本字符集：大写、小写、数字、符号（可配置）
- 长度滑块（4-128）+ 常用预设按钮（8/16/24/32）

生成：
```js
function generate(options) {
  const { len, upper, lower, digit, symbol } = options
  const pools = []
  if (upper) pools.push('ABCDEFGHIJKLMNOPQRSTUVWXYZ')
  if (lower) pools.push('abcdefghijklmnopqrstuvwxyz')
  if (digit) pools.push('0123456789')
  if (symbol) pools.push('!@#$%^&*()-_=+[]{};:,.?/')
  const all = pools.join('')
  // 使用 crypto.getRandomValues 优于 Math.random
  const arr = new Uint32Array(len)
  crypto.getRandomValues(arr)
  return Array.from(arr, x => all[x % all.length]).join('')
}
```
要点：
- 优先用 `crypto.getRandomValues` 提升随机性
- 确保“至少包含每类已勾选字符”（可先各取 1 再填满）

## 2. 强度评估与可视化

简单做法：基于长度与类型多样性打分；进阶可计算熵值（bits）：
```
熵 ≈ log2(字符集大小^长度) = 长度 * log2(字符集大小)
```
可视化：
- 颜色条或徽章（弱/中/强/极强）
- 旁边用文案提示“适合日常/高安全需求”等

## 3. 一键复制与可用性

- 复制到剪贴板（`navigator.clipboard.writeText`）并给出通知
- 回退处理：在不支持的环境中选中文本提示手动复制
- 输入框用 `readonly` 防止误改，提供“重新生成/清空”按钮

## 4. 批量生成与历史

- 支持一次生成 N 个（如 10/20/50），展示为列表并提供“复制全部”
- 本地保存最近使用的设置（localStorage），下次还原

## 5. 安全提示与边界

- 默认不开启符号时，给出“部分网站不接受某些符号”的说明
- 可选避免易混淆字符（如 0/O、1/l/I）
- 极长密码对输入/显示的影响（滚动与可见性）

## 6. 集成到 DevTools Hub

- 与现有 UI 对齐：长度滑块、预设按钮、字符类型复选卡片、生成/批量按钮
- 强度条与熵值在结果面板中展示
- `switchTool('password-generator')` 时刷新 UI

## 7. 小练习

- 增加一个“记忆型口令”模式（词库 + 分隔符 + 首字母大小写）
- 为批量结果新增“导出 CSV/JSON”下载
- 加入“避免重复字符”开关并处理熵值提示

---

上一章：03-JSON 工具实战  ｜  下一章：05-颜色调色板：HEX/RGB/HSL 互转、渐变与历史
