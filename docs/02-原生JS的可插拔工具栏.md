# 02｜用原生 JS 做一个可插拔工具栏（导航/深链接/快捷键）

本篇通过 DevTools Hub 的导航与工具切换实现，讲清如何在不依赖框架的情况下，做出“可插拔、可深链、可键盘操作”的工具面板。

目标：
- 拆解 `switchTool(toolId)` 的职责与 DOM 结构
- 实现 URL 深链接（`?tool=xxx` / `#xxx`）与状态恢复
- 支持 Alt+数字 快捷键切换工具

## 1. DOM 与类名约定

- 每个工具是一个 `.tool` 容器，具有唯一 `id`
- 当前可见工具拥有 `.active`
- 顶部导航按钮 `.nav-btn` 上有 `data-tool` 指向目标 id

好处：
- 结构清晰，样式与脚本都容易定位
- 增加新工具时，只需复制 DOM 片段并注册 id

## 2. 切换逻辑核心：`switchTool`

简化后的思想：
```js
function switchTool(toolId) {
  // 1) 取消旧的 active，激活新的
  // 2) 更新导航按钮状态
  // 3) 记录当前 toolId 到本地或全局状态
  // 4) 同步 URL（hash 或 query），便于分享/收藏
  // 5) 触发当前工具的 hooks（onMount/onShow）
}
```
DevTools Hub 里还将 `window.switchTool` 包装，附加：
- 更新 URL hash（深链接）
- 记录使用统计（本地，不上传）
- 解析初始 URL，在加载完成后跳转到指定工具

## 3. 深链接两种方式

- Query：`https://.../?tool=json-formatter`
- Hash：`https://.../#json-formatter`

推荐：两者都支持，兼容性最佳（有时前者更适合入口短链，后者适合站内导航）。

解析入口：
```js
const params = new URLSearchParams(location.search)
const initialFromQuery = params.get('tool')
const initialFromHash = location.hash.slice(1)
```

## 4. 快捷键：Alt + 数字

思想：将工具 id 映射到数字键，监听 `keydown`：
```js
const toolKeys = { '1': 'password-generator', '2': 'color-palette', /* ... */ }
window.addEventListener('keydown', (e) => {
  if (e.altKey && toolKeys[e.key]) {
    e.preventDefault()
    switchTool(toolKeys[e.key])
  }
})
```
注意：
- 在输入框聚焦时要谨慎拦截，避免影响输入体验
- 给用户视觉提示（如导航按钮上显示数字或 tooltip）

## 5. 增量接入一个新工具

步骤：
1) 在 `index.html` 复制一个 `.tool` 卡片，设置新 id；在 `.nav` 里加 `.nav-btn` 并 `data-tool` 对应
2) 在 `script.js` 的初始化中，根据需求在 `switchTool` 的 hooks 里做 onShow/onHide
3) 可选：调用 `DevToolsHub.registerTool('your-tool-id', { onMount, onShow, onHide })`
4) 如需深链，确保 id 已纳入支持列表（URL 解析无白名单则无需额外处理）

## 6. 小练习

- 给“文本对比器”加一个键盘快捷键 Alt+T（提示：监听 `e.key.toLowerCase() === 't'` 且配合 `e.altKey`）
- 在切换到某工具时，让其输入框自动聚焦
- 在返回首页时（如 `?tool=` 不存在）默认跳到“密码生成器”

下一篇：实现 JSON 工具的“格式化 + 校验 + 树视图”的思路与 UI 交互。

---

上一章：01-搭建一个纯前端 PWA 工具站（从 0 到可安装）  ｜  下一章：03-JSON 工具实战：从文本框到树视图与校验
